1
00:00:00,000 --> 00:00:06,974
[MUSIC]

2
00:00:06,974 --> 00:00:08,840
Welcome to this lecture.

3
00:00:08,840 --> 00:00:13,290
In this course, we aim to show a variety
of process discovery techniques.

4
00:00:13,290 --> 00:00:16,190
Today we will show that
transition systems can

5
00:00:16,190 --> 00:00:21,380
often be folded in much more compact
process models that allow for concurrency.

6
00:00:23,440 --> 00:00:31,550
In the last lecture we introduced
a two faced approach using regions.

7
00:00:31,550 --> 00:00:35,110
The first lecture we focused on
constructing the transition system,

8
00:00:35,110 --> 00:00:40,330
now we will focus on converting
the transition system into a Petri net,

9
00:00:40,330 --> 00:00:42,280
thereby discovering concurrency.

10
00:00:44,320 --> 00:00:45,930
So what's the basic idea?

11
00:00:45,930 --> 00:00:49,400
The basic idea is that in
the transition system,

12
00:00:49,400 --> 00:00:55,720
we identify a subset of states
that correspond exactly to a place.

13
00:00:56,780 --> 00:01:03,370
And by doing this, we introduce places
that are like constraints on the behavior,

14
00:01:03,370 --> 00:01:06,500
that capture the behavior
including concurrency.

15
00:01:06,500 --> 00:01:11,000
So it may be the case that we have
a transition system with thousands of

16
00:01:11,000 --> 00:01:15,490
states, and
by applying region theory we reduce it to

17
00:01:15,490 --> 00:01:18,780
a Petri net with a very
small number of places.

18
00:01:21,180 --> 00:01:24,410
So let's look at the definition of

19
00:01:24,410 --> 00:01:27,940
the understanding of what
a state-based region is.

20
00:01:27,940 --> 00:01:34,330
The idea is that we capture a set of states
and that if we look at the states and we

21
00:01:34,330 --> 00:01:40,550
look at the corresponding arrows entering
the region, exiting the region, and

22
00:01:40,550 --> 00:01:45,890
that remain inside or that remain outside,
we want the following property to hold.

23
00:01:47,190 --> 00:01:53,420
For example all a activities,
if one of them is entering

24
00:01:53,420 --> 00:01:59,570
as is the case here,
then all a arrows should enter the region.

25
00:01:59,570 --> 00:02:03,990
They cannot exit, and
they cannot be inside and remain inside.

26
00:02:05,110 --> 00:02:06,760
The same holds for b.

27
00:02:06,760 --> 00:02:10,060
If one b is entering,
then all b's should enter.

28
00:02:12,080 --> 00:02:15,800
If we look at c, c is exiting.

29
00:02:15,800 --> 00:02:20,560
So if there is one c arrow
going out of the region,

30
00:02:20,560 --> 00:02:24,830
then all c arrows should go out of
the region, and the same holds for d.

31
00:02:26,330 --> 00:02:32,520
The other activities, they do not
cross the boundary of such a region.

32
00:02:32,520 --> 00:02:38,450
So whenever there is consensus,
on entering, exiting, and

33
00:02:38,450 --> 00:02:42,960
not crossing, if we find a set of
states that has these properties,

34
00:02:42,960 --> 00:02:45,250
then we know that that is a region, and

35
00:02:45,250 --> 00:02:49,100
that it potentially corresponds to
a place in the corresponding Petri net.

36
00:02:51,180 --> 00:02:55,670
So the starting point as as mentioned
before is a transition system.

37
00:02:55,670 --> 00:03:00,830
In the examples we will, always assume
that we have one initial state.

38
00:03:00,830 --> 00:03:05,340
That is not necessarily always
the case but we can always add

39
00:03:05,340 --> 00:03:11,570
an artificial start activity to ensure
that there is one initial state.

40
00:03:11,570 --> 00:03:14,770
Typically we'll also prefer
to have one final state.

41
00:03:14,770 --> 00:03:18,260
But this is not really a limitation of
the techniques that we are talking about.

42
00:03:19,570 --> 00:03:24,070
All states in the transition system,

43
00:03:24,070 --> 00:03:25,320
of course, need to be reachable.

44
00:03:28,000 --> 00:03:33,070
So, here, we see the definition
that I mentioned before.

45
00:03:33,070 --> 00:03:39,350
So if one a is exiting,
all a's are exiting.

46
00:03:39,350 --> 00:03:44,650
If one a is entering,
then all a transitions should be entering.

47
00:03:44,650 --> 00:03:48,360
If one a does not cross
the boundary of a region,

48
00:03:48,360 --> 00:03:51,160
no a's should be allowed to
cross the boundary of a region.

49
00:03:52,400 --> 00:03:55,290
And that should hold for all activities.

50
00:03:55,290 --> 00:03:56,870
So that's the notion of a region.

51
00:03:58,490 --> 00:04:03,400
It is best to just look at a number of
examples to really understand this notion.

52
00:04:04,530 --> 00:04:07,820
So here the red states
together form a region.

53
00:04:08,930 --> 00:04:12,910
There is one a arc, and
that a arc is entering.

54
00:04:12,910 --> 00:04:15,230
So there is agreement on the a arc.

55
00:04:16,590 --> 00:04:21,510
If we look at the b arcs,
in this diagram you can see four.

56
00:04:21,510 --> 00:04:26,990
Then all the b arcs are going from
a red state to an uncolored state.

57
00:04:26,990 --> 00:04:28,560
So they are all exiting.

58
00:04:28,560 --> 00:04:31,670
So there is consensus on the exiting of b.

59
00:04:32,790 --> 00:04:38,280
If you look at c, d and
e, they are either inside and

60
00:04:38,280 --> 00:04:43,200
remain inside or they are outside and
remain outside, so they are not crossing.

61
00:04:44,270 --> 00:04:51,180
So later we will see that this actually
corresponds to a place where transition

62
00:04:51,180 --> 00:04:56,750
a is putting a token into, and
transition b is taking a token from.

63
00:04:58,940 --> 00:05:00,520
We can look at another region.

64
00:05:00,520 --> 00:05:04,400
Here, again, we see four states, and
if you look at these four states,

65
00:05:04,400 --> 00:05:09,290
they form a region where
a is not crossing,

66
00:05:09,290 --> 00:05:15,440
b is entering, e is exiting,
c and d do not cross.

67
00:05:15,440 --> 00:05:20,640
Later we will see that this
corresponds to the place connecting b

68
00:05:22,260 --> 00:05:23,370
to the final transition.

69
00:05:26,130 --> 00:05:27,910
This is another region.

70
00:05:27,910 --> 00:05:30,850
Now it consists of just a single state.

71
00:05:30,850 --> 00:05:33,350
A is exiting the rest does not cross.

72
00:05:34,410 --> 00:05:38,030
What we see if we look at this
particular region is that it

73
00:05:38,030 --> 00:05:40,350
contains the initial state.

74
00:05:40,350 --> 00:05:46,520
If that is the case we will mark
the corresponding place with a token.

75
00:05:46,520 --> 00:05:51,880
So all regions that correspond,
that contain the initial state,

76
00:05:53,210 --> 00:05:57,810
they correspond to a marked place,
that initially has one token.

77
00:05:59,890 --> 00:06:05,629
This is another region, now d is exiting,
a is entering, the rest does not cross.

78
00:06:07,070 --> 00:06:09,940
Let us now take a look at
something that is not a region so

79
00:06:09,940 --> 00:06:12,030
that we have a good
understanding of the notion.

80
00:06:13,400 --> 00:06:18,090
If we look at this example with
the three states colored red,

81
00:06:18,090 --> 00:06:22,930
together they do not form
a region because we see b

82
00:06:22,930 --> 00:06:29,010
arcs that are exiting,
every cb arcs that are not crossing.

83
00:06:29,010 --> 00:06:34,690
So there is no consensus with
respect to the b transitions.

84
00:06:34,690 --> 00:06:37,670
There's also no consensus
with respect to c and d.

85
00:06:38,940 --> 00:06:42,080
Some arcs are exiting,
some of them are not crossing.

86
00:06:43,390 --> 00:06:45,250
So this is not a region.

87
00:06:45,250 --> 00:06:48,720
Also this is not a region,
for very similar reasons.

88
00:06:48,720 --> 00:06:53,780
If we just take a look at these
two states, then we see a b

89
00:06:53,780 --> 00:06:59,560
that is exiting, but
we also see b's that are not crossing.

90
00:06:59,560 --> 00:07:01,280
The same holds for c and d.

91
00:07:01,280 --> 00:07:02,430
So this is not a region.

92
00:07:03,970 --> 00:07:08,490
So there may be multiple regions
on this small transition system.

93
00:07:08,490 --> 00:07:12,590
You can see here in the different
colors the different regions.

94
00:07:12,590 --> 00:07:16,610
But any combination of two
regions is again a region.

95
00:07:16,610 --> 00:07:20,100
And so
the number of regions seems to explode.

96
00:07:21,220 --> 00:07:25,630
So, if we selectively
choose the right regions we

97
00:07:25,630 --> 00:07:30,020
get a corresponding nice process
model as you can see here.

98
00:07:30,020 --> 00:07:32,800
But the question is,
how to select the right regions?

99
00:07:34,170 --> 00:07:40,590
To really understand the fact that
we need to select the right regions,

100
00:07:40,590 --> 00:07:46,170
it is good to look at some examples and
count the number of regions.

101
00:07:47,200 --> 00:07:53,950
So take a look at this Petri net, where we
have a number of concurrent activities.

102
00:07:53,950 --> 00:07:56,040
We can construct the reachability graph.

103
00:07:56,040 --> 00:07:59,989
We can all imagine what
the reachability graph looks like.

104
00:08:01,020 --> 00:08:04,680
How many regions does
this reachability graph,

105
00:08:04,680 --> 00:08:07,160
which is a transition system,
actually have?

106
00:08:08,450 --> 00:08:09,790
Take a moment to think about it.

107
00:08:14,520 --> 00:08:16,240
Now let's take a look at the answer.

108
00:08:16,240 --> 00:08:21,669
So there are two to the power n states
if there are n concurrent activities.

109
00:08:23,350 --> 00:08:28,170
Then, if we look at the regions,
we cannot have the situation,

110
00:08:28,170 --> 00:08:30,130
which is illustrated here.

111
00:08:30,130 --> 00:08:35,590
Where for example two activities
are both exiting, a and b.

112
00:08:35,590 --> 00:08:38,510
Because if we are in this situation,

113
00:08:38,510 --> 00:08:43,050
then we also know that there will be
a's and b's that are not crossing.

114
00:08:44,070 --> 00:08:51,650
So at most, one transition label can be
crossing the boundary of the region.

115
00:08:52,810 --> 00:08:59,510
So if we use this reasoning, then we
can see that there are n ways to split

116
00:08:59,510 --> 00:09:04,070
the states into two groups and each of
these two groups correspond to a region.

117
00:09:05,680 --> 00:09:10,110
Also the empty set,
the set consisting of no states, and

118
00:09:10,110 --> 00:09:13,800
the set consisting of all states,
they are regions.

119
00:09:13,800 --> 00:09:20,600
So we get 2 times n plus 1, regions
that are possible in this situation.

120
00:09:20,600 --> 00:09:21,690
So this is quite okay.

121
00:09:23,780 --> 00:09:26,870
However let us now look
at the next question.

122
00:09:26,870 --> 00:09:30,840
Now we have a sequence of n activities,

123
00:09:30,840 --> 00:09:35,480
to there are n plus 1 states before,
after, and in between.

124
00:09:36,610 --> 00:09:39,600
So how many regions does
the reachability graph,

125
00:09:39,600 --> 00:09:42,600
which is a transition system of
this particular Petri net, have?

126
00:09:43,920 --> 00:09:46,049
Again, take a moment to think about this.

127
00:09:49,620 --> 00:09:55,590
The answer is that every subset of
states corresponds to a region.

128
00:09:55,590 --> 00:09:59,590
So you have 2 to the power
n plus 1 possible regions.

129
00:10:01,450 --> 00:10:06,320
Many of these regions look
redundant if we convert them

130
00:10:06,320 --> 00:10:08,170
back to places in the Petri net.

131
00:10:09,740 --> 00:10:14,300
Any combination of states,
corresponds to a region.

132
00:10:14,300 --> 00:10:18,820
So, in this particular example if you
would take a look at ten activities,

133
00:10:18,820 --> 00:10:22,960
executed in sequence,
we have more than 2,000 possible regions.

134
00:10:22,960 --> 00:10:27,313
So imagine a Petri net with
more than 2,000 places just to

135
00:10:27,313 --> 00:10:30,177
describe a sequence of ten activities.

136
00:10:30,177 --> 00:10:37,190
It shows that we need to reduce the number
of regions that we are looking at and

137
00:10:37,190 --> 00:10:41,490
therefore, we only consider minimal,
non-trivial regions.

138
00:10:43,000 --> 00:10:45,440
So let us define these notions.

139
00:10:45,440 --> 00:10:48,550
We only include non-trivial,
minimal regions.

140
00:10:50,210 --> 00:10:57,330
First of all, we discard the so called
trivial regions, the empty set of states,

141
00:10:57,330 --> 00:11:01,560
and the set of all states,
they are regions by definition, but

142
00:11:01,560 --> 00:11:06,550
they carry no information whatsoever,
so we will not consider these.

143
00:11:06,550 --> 00:11:10,820
Moreover, if a region
can be decomposed into

144
00:11:10,820 --> 00:11:15,732
smaller non-trivial regions, then we
will not consider the higher region.

145
00:11:15,732 --> 00:11:16,906
Okay.

146
00:11:16,906 --> 00:11:20,160
because otherwise we get
an explosion of combinations.

147
00:11:21,580 --> 00:11:24,460
Let's take a look what
this actually means.

148
00:11:24,460 --> 00:11:29,400
So if we for
example first look at our example and

149
00:11:29,400 --> 00:11:36,310
we look at trivial regions, then the set
of all states and the empty set of states,

150
00:11:36,310 --> 00:11:40,450
they are both regions but they are
trivial, so we will never consider them.

151
00:11:42,870 --> 00:11:45,600
To understand the notion
of minimal regions we

152
00:11:45,600 --> 00:11:47,980
first need to understand
the notion of a compliment.

153
00:11:49,030 --> 00:11:52,109
In this case we have the region
consisting of one blue state.

154
00:11:53,260 --> 00:12:00,080
If we take all states minus this blue
state, this is the so-called complement,

155
00:12:00,080 --> 00:12:05,150
indicated here by the red states, then
by definition that is also the region.

156
00:12:05,150 --> 00:12:11,940
So if we have a region then all the states
minus this region is again a region.

157
00:12:13,370 --> 00:12:15,870
So if we understand
the notion of a complement,

158
00:12:15,870 --> 00:12:20,910
we can now try to understand why
we only consider minimal regions.

159
00:12:20,910 --> 00:12:26,320
If we have a larger region, and
we have a smaller region contained

160
00:12:26,320 --> 00:12:30,100
in it, and we take the difference
between the larger region and

161
00:12:30,100 --> 00:12:34,930
the smaller region, then the result,
by definition, is again a region.

162
00:12:37,320 --> 00:12:41,220
If we again take a look at this
region indicated here in yellow,

163
00:12:41,220 --> 00:12:44,110
then the question,
is this a minimal region?

164
00:12:44,110 --> 00:12:46,870
Does it contain other regions?

165
00:12:46,870 --> 00:12:55,380
And if we look closely, we can see that
the last state, is again a region.

166
00:12:55,380 --> 00:13:00,280
So, we have the, the yellow region,
we have the green region, and again, if we

167
00:13:00,280 --> 00:13:05,070
take the difference between the larger and
the smaller one, we again get a region.

168
00:13:06,090 --> 00:13:12,800
So this means that we can break down
larger regions into smaller regions and

169
00:13:12,800 --> 00:13:18,740
if we can no longer identify nontrivial
regions in them, they are minimal.

170
00:13:18,740 --> 00:13:23,050
And the idea is that in all of our
reasoning we will only consider minimal

171
00:13:23,050 --> 00:13:27,880
regions, in order to reduce
an explosion of the number of

172
00:13:27,880 --> 00:13:30,730
places in the Petri net.

173
00:13:32,320 --> 00:13:37,240
So in our running example, if we look at
all the minimal regions they are indicated

174
00:13:37,240 --> 00:13:45,020
here, and if you convert them into places
we get the corresponding Petri net.

175
00:13:45,020 --> 00:13:46,720
So, how does it work exactly?

176
00:13:48,350 --> 00:13:51,349
For each transition label
in the transition system,

177
00:13:51,349 --> 00:13:54,290
we add a transition to
the corresponding Petri net.

178
00:13:55,610 --> 00:13:58,940
There may be many transitions in
the transition system that have

179
00:13:58,940 --> 00:14:02,010
the same label but they're all
mapped onto the same transition.

180
00:14:03,150 --> 00:14:06,770
Then we compute the minimal
non trivial regions.

181
00:14:06,770 --> 00:14:11,660
We're just breaking down regions into
smaller parts until they can no longer be

182
00:14:11,660 --> 00:14:12,700
further decomposed.

183
00:14:14,890 --> 00:14:19,870
Then each of these minimal non-trivial
regions is converted into a place in

184
00:14:19,870 --> 00:14:23,500
the Petri net, and the inputs and

185
00:14:23,500 --> 00:14:28,680
outputs are clear by looking at what
is entering and exiting the region.

186
00:14:30,440 --> 00:14:35,390
And we add a token to each place
that corresponds to a region,

187
00:14:35,390 --> 00:14:37,350
that contains the initial state.

188
00:14:39,350 --> 00:14:43,750
So if we do that the result
is a minimal saturated net.

189
00:14:43,750 --> 00:14:45,950
And in our example it looks like this.

190
00:14:45,950 --> 00:14:49,310
So this is exactly the Petri net
that you would like to have.

191
00:14:51,560 --> 00:14:55,430
So ProM supports
the construction of regions.

192
00:14:55,430 --> 00:15:00,760
And a simple test to see whether it
works well is that we take a Petri net.

193
00:15:02,270 --> 00:15:06,570
We construct the corresponding
reachability graph,

194
00:15:06,570 --> 00:15:09,920
using the techniques that we
saw in the previous lecture.

195
00:15:09,920 --> 00:15:14,750
And we get a reachability graph,
which in this case is very large.

196
00:15:14,750 --> 00:15:18,620
And so here we see the top part,
we can zoom out a bit.

197
00:15:18,620 --> 00:15:20,400
And we can see that there are many states.

198
00:15:20,400 --> 00:15:22,910
There are more than 1000 states, and

199
00:15:22,910 --> 00:15:25,350
it's impossible to visualize
this in a proper way.

200
00:15:26,400 --> 00:15:32,110
So this is a transition system that
is very large and very complicated.

201
00:15:32,110 --> 00:15:39,020
But if we now apply state based
regions to this transition system and

202
00:15:39,020 --> 00:15:45,640
apply the algorithm just described, then
this is the Petri net that we rediscover.

203
00:15:45,640 --> 00:15:51,380
So, from this mess of all these states and
all these transitions we are able to

204
00:15:51,380 --> 00:15:54,550
rediscovered the concurrency that
was there in the first place.

205
00:15:56,580 --> 00:15:59,940
So let us take a look at another example.

206
00:15:59,940 --> 00:16:03,100
So here we see a log,
with the traces indicated.

207
00:16:03,100 --> 00:16:06,650
We have seen this in the context
of the Alpha algorithm.

208
00:16:06,650 --> 00:16:12,160
If we use the approach just described, so
we first construct a transition system.

209
00:16:13,190 --> 00:16:18,730
Then we take this transition system and
apply state-based regions to it,

210
00:16:18,730 --> 00:16:20,800
then this is the Petri net that we get.

211
00:16:20,800 --> 00:16:25,550
And this is the Petri net which is
exactly the same as we would find if we

212
00:16:25,550 --> 00:16:27,770
would apply the Alpha algorithm.

213
00:16:27,770 --> 00:16:32,140
Note that again we have these two
redundant places towards the end of

214
00:16:32,140 --> 00:16:33,470
the process model.

215
00:16:35,010 --> 00:16:40,285
There are, however, also situations
where state based regions really

216
00:16:40,285 --> 00:16:45,160
produce a better result than
the Alpha algorithm would do.

217
00:16:45,160 --> 00:16:49,560
So for example if we take a look at
this log, we see the sequences a,

218
00:16:49,560 --> 00:16:52,270
c, and d, b, c, and e.

219
00:16:53,770 --> 00:16:57,610
If we create the transition
system it looks like this.

220
00:16:57,610 --> 00:17:00,270
We are using the past with
a multiset abstraction.

221
00:17:01,280 --> 00:17:06,460
And now if we compute the regions for
this example and convert this

222
00:17:06,460 --> 00:17:10,319
into places of the corresponding
Petri net, then we discover this.

223
00:17:11,670 --> 00:17:18,370
And please note the two highlighted
places, these are places

224
00:17:19,430 --> 00:17:25,912
that capture the causality between a and
d, and the causality between b and

225
00:17:25,912 --> 00:17:32,500
e, even though a and b and b and
e never follow one another.

226
00:17:32,500 --> 00:17:35,900
So the Alpha algorithm would produce
a model that is too general in

227
00:17:35,900 --> 00:17:39,310
this situation, but using regions,
we can find the right model.

228
00:17:41,660 --> 00:17:47,930
In the next lecture, we will focus on
the limitations of this two-step approach.

229
00:17:47,930 --> 00:17:53,400
So we will look at under which
circumstances will it not work, and

230
00:17:53,400 --> 00:17:56,100
what are possible extensions
that can be used.

231
00:17:57,670 --> 00:17:59,670
We are still in Chapter 6,

232
00:17:59,670 --> 00:18:03,470
where we consider all these more
advanced process discovery techniques.

233
00:18:05,930 --> 00:18:09,314
Thank you for watching,
and hope to see you soon.

234
00:18:09,314 --> 00:18:19,314
[MUSIC]

