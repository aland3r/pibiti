1
00:00:00,000 --> 00:00:06,849
[MUSIC]

2
00:00:06,849 --> 00:00:08,245
Glad to see you again.

3
00:00:08,245 --> 00:00:13,805
Today we will continue with Petri Nets,
a foundation of process modeling notation,

4
00:00:13,805 --> 00:00:19,224
that you need to understand first before
we can look at process mining approaches.

5
00:00:19,224 --> 00:00:22,578
In the last lecture, we took a look at

6
00:00:22,578 --> 00:00:27,920
these two Petri Nets that both
model a safe traffic light.

7
00:00:27,920 --> 00:00:30,168
And they both have the property,

8
00:00:30,168 --> 00:00:34,841
that at any point in time at least
one of the two traffic lights is red.

9
00:00:34,841 --> 00:00:38,249
One is alternating,
the other is non-deterministic.

10
00:00:40,420 --> 00:00:47,610
If we take a look at the non-deterministic
model of these two safe traffic lights,

11
00:00:48,610 --> 00:00:53,940
we can see that initial marking
is a multi-set of tokens.

12
00:00:53,940 --> 00:00:56,010
There is one token in place r1.

13
00:00:57,010 --> 00:01:01,540
One token in place r2,
and one token in place x.

14
00:01:01,540 --> 00:01:06,883
Then we can talk about a set
of reachable markings, and

15
00:01:06,883 --> 00:01:11,541
we will find several reachable markings.

16
00:01:11,541 --> 00:01:14,089
Each represented as has a multi-set.

17
00:01:14,089 --> 00:01:18,818
And so here, on this slide,
there are enumerated and

18
00:01:18,818 --> 00:01:22,295
we can see all the reachable markings.

19
00:01:22,295 --> 00:01:26,086
If we want to know what
are the reachable markings,

20
00:01:26,086 --> 00:01:29,878
we typically construct
a reachability graph, and

21
00:01:29,878 --> 00:01:35,539
a reachability graph can be seen as
a particular type of transition system.

22
00:01:35,539 --> 00:01:38,409
A transition system with
one initial state, and

23
00:01:38,409 --> 00:01:41,070
with an undefined number
of final markings.

24
00:01:42,800 --> 00:01:48,810
So for the traffic lights, this is
the corresponding reachability graph, and

25
00:01:48,810 --> 00:01:53,360
it is showing the five reachable
states that I showed earlier.

26
00:01:54,660 --> 00:01:59,720
So the arrow indicates that the traffic
light starts in the state with

27
00:01:59,720 --> 00:02:03,520
the token in r1, r2, and x.

28
00:02:03,520 --> 00:02:07,880
And from that state,
two transitions are possible.

29
00:02:07,880 --> 00:02:10,540
One is rg1, one is rg2.

30
00:02:11,730 --> 00:02:16,681
And by just simply trying
all possibilities we get

31
00:02:16,681 --> 00:02:22,823
this reachability graph showing
all the reachable markings.

32
00:02:22,823 --> 00:02:25,230
So, let's take a look at another example.

33
00:02:25,230 --> 00:02:28,121
So, here you see a Petri
net with two transitions.

34
00:02:28,121 --> 00:02:30,785
There are two tokens in p1.

35
00:02:30,785 --> 00:02:32,250
There's one token in p3.

36
00:02:33,550 --> 00:02:37,180
And we can look at what
are the reachable markings,

37
00:02:37,180 --> 00:02:39,690
by creating the reachability graph.

38
00:02:41,610 --> 00:02:43,810
This is the reachability graph.

39
00:02:43,810 --> 00:02:46,109
So let's take a look at it.

40
00:02:46,109 --> 00:02:51,450
We start in the initial states,
where there is a token in p3,

41
00:02:51,450 --> 00:02:56,912
and there are two tokens in p1,
indicated by the small 2.

42
00:02:56,912 --> 00:03:01,920
So we are talking about
the multi-set of tokens in places.

43
00:03:03,030 --> 00:03:06,980
In this particular initial marking,
transition t1,

44
00:03:06,980 --> 00:03:10,130
is enabled and transition t2 is enabled.

45
00:03:10,130 --> 00:03:13,530
Assume that we execute transition t1,

46
00:03:13,530 --> 00:03:17,850
then we consume a token from p1,
and produce a token for p2.

47
00:03:18,850 --> 00:03:22,700
So the resulting marking is
the marking with a token in p1,

48
00:03:22,700 --> 00:03:25,580
a token in p2, and a token in p3.

49
00:03:28,050 --> 00:03:33,090
So in the reachability graph,
we add this particular marking.

50
00:03:33,090 --> 00:03:34,823
Then in this marking,

51
00:03:34,823 --> 00:03:41,029
we can again look what are the transitions
that are enabled t1 is still enabled,

52
00:03:41,029 --> 00:03:46,706
because there were two tokens is p1, and
now one remains and t2 is also enabled.

53
00:03:46,706 --> 00:03:51,699
Assume that t1 occurs,
then we end up in this,

54
00:03:51,699 --> 00:03:57,382
in the marking with two tokens in p2,
and one token in p3.

55
00:03:57,382 --> 00:04:02,592
And now there is only one possibility,
namely that t2 fires,

56
00:04:02,592 --> 00:04:07,617
removing the token from p3,
and putting a token in p4.

57
00:04:07,617 --> 00:04:11,606
This is just one of several
possible scenarios when we start in

58
00:04:11,606 --> 00:04:13,280
the initial state.

59
00:04:13,280 --> 00:04:18,770
We could also have executed first t2,
ending up in this marking.

60
00:04:18,770 --> 00:04:25,850
And then we would have to execute t1 once,
and t1 for the second time.

61
00:04:25,850 --> 00:04:30,750
Another scenario would have been that
we would have executed t1 first,

62
00:04:30,750 --> 00:04:32,287
then t2 and then t1.

63
00:04:32,287 --> 00:04:37,053
And then we have explored all
possibilities and we get a reachability

64
00:04:37,053 --> 00:04:42,803
graph that you see here, which is simply
showing all the reachable markings,

65
00:04:42,803 --> 00:04:47,421
and showing the transitions from
one marking to another marking.

66
00:04:47,421 --> 00:04:53,001
And this is also called
a transition system.

67
00:04:53,001 --> 00:04:58,088
Let's take a look at the slightly
more complicated situation,

68
00:04:58,088 --> 00:05:01,677
where t2 is also consuming tokens from p1.

69
00:05:01,677 --> 00:05:05,877
So they are competing for
the tokens in p1.

70
00:05:05,877 --> 00:05:10,789
So construct the reachability graph.

71
00:05:10,789 --> 00:05:14,193
If you construct it, this is what you see.

72
00:05:14,193 --> 00:05:19,794
So initially both t1 and t2 are enabled.

73
00:05:19,794 --> 00:05:27,420
If t2 occurs, then a token is removed
from p3, and a token is removed from p1.

74
00:05:28,580 --> 00:05:35,577
And that results in the state with
the token in p1, and a token in p4.

75
00:05:35,577 --> 00:05:40,810
In that state, the only thing that
can happen is that we execute t1,

76
00:05:40,810 --> 00:05:43,889
and then we end up in the state p2, p4.

77
00:05:43,889 --> 00:05:48,324
But there is another scenario
that we first execute t1.

78
00:05:48,324 --> 00:05:49,477
If we execute t1,

79
00:05:49,477 --> 00:05:53,600
we end up in a state where there is
still a choice between t1 and t2.

80
00:05:54,760 --> 00:05:57,463
And then we have explored
all possibilities.

81
00:05:57,463 --> 00:06:02,570
So this is the reachability graph
of this particular Petri net.

82
00:06:02,570 --> 00:06:05,354
So far, we only looked at Petri nets,

83
00:06:05,354 --> 00:06:10,139
where there is just a single arc between
a place and a transition, but

84
00:06:10,139 --> 00:06:14,414
in a Petri net, if you want,
it can also be multiple arcs.

85
00:06:14,414 --> 00:06:22,318
So in this particular example,
t2 requires two tokens from p1,

86
00:06:22,318 --> 00:06:28,964
t2 if it occurs,
it will produce three tokens for p2.

87
00:06:28,964 --> 00:06:32,596
So t1 has three output
arcs to the same place,

88
00:06:32,596 --> 00:06:38,200
t2 has two input arcs from the same place,
and the meaning is obvious.

89
00:06:38,200 --> 00:06:41,510
It indicates a number of
tokens to be consumed and

90
00:06:41,510 --> 00:06:43,060
the number of tokens to be produced.

91
00:06:44,140 --> 00:06:48,070
So if we construct a reachability graph,
this is what we get.

92
00:06:49,580 --> 00:06:56,527
So again, if we look at initial situation,
both t1 and t2 are enabled.

93
00:06:56,527 --> 00:07:02,074
If we execute t2,
we remove two tokens from p1,

94
00:07:02,074 --> 00:07:07,487
and one token from p3,
and produce one token for

95
00:07:07,487 --> 00:07:13,048
p4, as is indicated in
the reachability graph.

96
00:07:13,048 --> 00:07:19,491
If on the other hand t1 executes,
then we consume a token from p1,

97
00:07:19,491 --> 00:07:22,781
and produce three tokens for p3.

98
00:07:22,781 --> 00:07:23,570
Sorry, for p2.

99
00:07:25,310 --> 00:07:30,894
So in this model,
it is possible that t1 fires once.

100
00:07:30,894 --> 00:07:32,500
Fires again.

101
00:07:32,500 --> 00:07:34,929
And fires for a third time.

102
00:07:34,929 --> 00:07:37,740
Resulting in nine tokens in p2.

103
00:07:37,740 --> 00:07:42,006
So this shows that in a Petri net,
arcs can have multiplicities and

104
00:07:42,006 --> 00:07:43,767
their meaning is obvious.

105
00:07:43,767 --> 00:07:49,377
And we can still construct
the reachability graph.

106
00:07:49,377 --> 00:07:53,052
One of the interesting features
of a reachability graph is

107
00:07:53,052 --> 00:07:56,802
that given a small Petri net
like the one that is shown here,

108
00:07:56,802 --> 00:08:00,930
the corresponding reachability
graph may be infinitely large.

109
00:08:02,000 --> 00:08:06,653
So if you would construct
the reachability graph of this model,

110
00:08:06,653 --> 00:08:10,800
you would end up in a process
that would never terminate.

111
00:08:10,800 --> 00:08:13,938
If you look at the model carefully,

112
00:08:13,938 --> 00:08:19,200
you will see that you can execute t1,
you can execute t2.

113
00:08:19,200 --> 00:08:23,584
And if you execute t2,
you also put a token in p3.

114
00:08:23,584 --> 00:08:28,642
And again, you can execute t1,
t2, t1, t2.

115
00:08:28,642 --> 00:08:31,617
And you can repeat this as
many times as you want.

116
00:08:31,617 --> 00:08:35,251
And in every round,
there will be a token in p3.

117
00:08:35,251 --> 00:08:40,260
And this will continue
until you execute t3.

118
00:08:40,260 --> 00:08:43,064
And in each round that you execute t1 and

119
00:08:43,064 --> 00:08:46,291
t2, you will put
an additional token in p3.

120
00:08:46,291 --> 00:08:49,776
So the number of reachable
markings is infinite.

121
00:08:52,979 --> 00:08:57,522
So this gave you some idea that given
a Petri net generate behavior, and

122
00:08:57,522 --> 00:09:01,687
that behavior can be expressed in
terms of a reachability graph,

123
00:09:01,687 --> 00:09:04,280
which is actually a transition system.

124
00:09:04,280 --> 00:09:08,937
Now let us take a look at a slightly
more involved Petri net, and

125
00:09:08,937 --> 00:09:12,892
then you can see that
modeling is very challenging.

126
00:09:12,892 --> 00:09:18,793
And that is why you need to make
exercises to really understand

127
00:09:18,793 --> 00:09:25,501
the process of modeling a process,
because this is far from trivial.

128
00:09:25,501 --> 00:09:27,473
Let us take a look at an example and

129
00:09:27,473 --> 00:09:30,508
I should warn you,
this is not a trivial exercise.

130
00:09:30,508 --> 00:09:34,460
You will need quite some time
to model this from scratch.

131
00:09:34,460 --> 00:09:37,587
If you are not used to
the Petri net notation or

132
00:09:37,587 --> 00:09:41,549
you are not experienced in
process modeling in general.

133
00:09:41,549 --> 00:09:44,330
So suppose that we have one train.

134
00:09:44,330 --> 00:09:51,472
And that we would like to model a circular
railway system, with four stations.

135
00:09:51,472 --> 00:09:55,285
We also have passengers and
they may hop on or

136
00:09:55,285 --> 00:10:00,334
hop off at the various stations,
but they can only hop on or

137
00:10:00,334 --> 00:10:06,230
hop off, if the train is standing
still in one of the four stations.

138
00:10:08,230 --> 00:10:11,230
The train has a capacity of 50 persons.

139
00:10:11,230 --> 00:10:16,970
So if the train is full,
no passengers can hop on.

140
00:10:16,970 --> 00:10:20,750
And, of course, no passengers can
hop off if the train is empty.

141
00:10:22,350 --> 00:10:27,190
So I would like to ask you to model
the above process in terms of a Petri net.

142
00:10:28,250 --> 00:10:31,210
And after you have answered that question,

143
00:10:31,210 --> 00:10:35,080
please tell me what a number
of reachable states is.

144
00:10:35,080 --> 00:10:38,914
And again, this will take some time for
you to model.

145
00:10:44,135 --> 00:10:47,180
I hope you've tried to make this model.

146
00:10:47,180 --> 00:10:49,854
Let's now take a look at the solution and

147
00:10:49,854 --> 00:10:52,026
let me start by giving a couple of hints.

148
00:10:52,026 --> 00:10:54,920
So, how to describe
the state of the train?

149
00:10:55,950 --> 00:11:00,160
The state of the train is
determined by the location, and

150
00:11:00,160 --> 00:11:02,190
by the number of passengers it holds.

151
00:11:02,190 --> 00:11:03,970
How to model that?

152
00:11:03,970 --> 00:11:05,710
What are possible actions?

153
00:11:05,710 --> 00:11:09,370
A train can move and
people can hop on and hop off.

154
00:11:09,370 --> 00:11:12,700
And you also need to think
when they are possible.

155
00:11:13,750 --> 00:11:19,880
If you model this small process in terms
of a Petri net, it looks like this.

156
00:11:19,880 --> 00:11:24,030
And this solution may
look a bit intimidating,

157
00:11:24,030 --> 00:11:26,320
if you're not used to things like this.

158
00:11:26,320 --> 00:11:29,290
But let me try to explain it step by step.

159
00:11:30,900 --> 00:11:36,720
So let's first take a look,
at the state of the train.

160
00:11:36,720 --> 00:11:41,240
And now I mean by the state of the train,
the location where it is.

161
00:11:41,240 --> 00:11:46,850
It is in one of the four stations, or it
is moving from one station to another one.

162
00:11:48,060 --> 00:11:51,000
So you get to circular Petri net

163
00:11:51,000 --> 00:11:56,690
with one token representing the train and
indicating where it is.

164
00:11:56,690 --> 00:12:02,330
So I think everybody can understand
this model in isolation.

165
00:12:02,330 --> 00:12:09,476
We didn't model any of the passengers,
so let's try to model the passengers.

166
00:12:09,476 --> 00:12:14,920
So that is indicated by this small model.

167
00:12:14,920 --> 00:12:20,510
So what this model is indicating
is that there are tokens

168
00:12:20,510 --> 00:12:25,390
that either represent
a free slot in the train,

169
00:12:25,390 --> 00:12:31,900
a free position or that represent
a passenger being on that train.

170
00:12:31,900 --> 00:12:36,900
So there are 50 tokens distributed
over two places.

171
00:12:36,900 --> 00:12:41,460
Now all the 50 tokens, are in the place

172
00:12:41,460 --> 00:12:47,126
indicating that there
is still three places.

173
00:12:47,126 --> 00:12:51,014
But these tokens can also be in
the other place indicating that

174
00:12:51,014 --> 00:12:53,348
there are passengers on this train.

175
00:12:53,348 --> 00:12:58,990
The transitions model hopping on and
hopping off, at the different stations.

176
00:12:58,990 --> 00:13:01,350
So I hope that everybody
can understand this model.

177
00:13:02,430 --> 00:13:07,250
And now we can merge these two simpler
models, into this overall model.

178
00:13:08,360 --> 00:13:11,680
So I've merged the two models
that I've showed to you before.

179
00:13:11,680 --> 00:13:17,260
And it is important that you
take a look at the green arcs,

180
00:13:17,260 --> 00:13:19,400
that actually represent two arcs.

181
00:13:19,400 --> 00:13:22,990
One arc for consumption,
and one arc for production.

182
00:13:24,670 --> 00:13:29,559
And together, they provide
a solution of the overall exercise.

183
00:13:31,080 --> 00:13:36,100
It is now enforced that
passengers can only hop on and

184
00:13:36,100 --> 00:13:40,650
hop off, in stations when the train
is standing still, and they

185
00:13:40,650 --> 00:13:44,400
cannot do this when the train is moving
from one station to another station.

186
00:13:46,640 --> 00:13:50,672
Another part of the question was,
how many reachable states there are?

187
00:13:50,672 --> 00:13:52,942
In total there are 51 times 8.

188
00:13:52,942 --> 00:13:56,300
So we can look at the location
of the train, and

189
00:13:56,300 --> 00:13:59,518
we can look at the number of passengers.

190
00:13:59,518 --> 00:14:03,979
And there are 51 possible states when
we look at the number of passengers.

191
00:14:03,979 --> 00:14:07,035
We count from 0 to 50.

192
00:14:07,035 --> 00:14:11,170
So there are 408 reachable markings.

193
00:14:11,170 --> 00:14:15,636
And this example illustrates that
very quickly you cannot model

194
00:14:15,636 --> 00:14:20,596
things anymore in terms of reachability
graph, a computer can compute

195
00:14:20,596 --> 00:14:26,400
the reachability graphs in a matter of
milliseconds for such a small example.

196
00:14:26,400 --> 00:14:28,390
But when you try to draw it,
it's already very large.

197
00:14:28,390 --> 00:14:31,854
And this shows the power of higher
level models like Petri net.

198
00:14:34,200 --> 00:14:39,928
So let's go back to the,
to the process mining challenge, and

199
00:14:39,928 --> 00:14:46,753
look at Petri nets in the context
of play-in, play-out and replay.

200
00:14:46,753 --> 00:14:52,237
So this is the classical use of models,
Play-Out and we see nothing surprising.

201
00:14:52,237 --> 00:14:55,161
Now you have a background in Petri nets,
and

202
00:14:55,161 --> 00:14:59,280
you can easily see that this is
a possible trace of this model.

203
00:15:00,340 --> 00:15:05,330
But now you need to think in of it
in terms of, creating an event log.

204
00:15:05,330 --> 00:15:09,210
By playing out the model,
we can create an event log.

205
00:15:09,210 --> 00:15:09,210


206
00:15:11,710 --> 00:15:12,730
So, that's play-out.

207
00:15:13,955 --> 00:15:18,610
Play-In, we get a bunch of traces, and

208
00:15:18,610 --> 00:15:21,740
we automatically would
like to construct a model.

209
00:15:21,740 --> 00:15:24,920
Later, we will see for example,
the alpha algorithm,

210
00:15:24,920 --> 00:15:28,890
which will produce exactly this model
given this set of example traces.

211
00:15:30,380 --> 00:15:32,040
Then we have Replay.

212
00:15:32,040 --> 00:15:36,630
It looks very much the same
as what I showed you before.

213
00:15:36,630 --> 00:15:42,250
So, we are now replaying a trace that
we saw in a reality on top of a model.

214
00:15:42,250 --> 00:15:44,250
Now we illustrate it in
terms of a Petri net.

215
00:15:45,470 --> 00:15:47,780
So we did not find any deviations.

216
00:15:47,780 --> 00:15:53,330
We can look at another example,
where we execute a trace a, e, d.

217
00:15:53,330 --> 00:15:56,040
And again,
we find no surprises whatsoever.

218
00:15:58,290 --> 00:16:00,090
So again, we see no deviations.

219
00:16:01,350 --> 00:16:07,030
But the replay becomes very interesting,
if reality deviates from the model.

220
00:16:07,030 --> 00:16:09,930
So now we look at the trace a, c, d.

221
00:16:09,930 --> 00:16:12,480
And it does not fit into this model.

222
00:16:12,480 --> 00:16:17,801
And we can very easily see that using
the firing rule of Petri nets and

223
00:16:17,801 --> 00:16:22,950
just by playing the token game,
we can see that there is a problem.

224
00:16:22,950 --> 00:16:26,830
So we, we did a, we executed transition c.

225
00:16:28,160 --> 00:16:32,880
Now in the trace, it is indicated
that in reality d happened,

226
00:16:32,880 --> 00:16:37,300
whereas in the model this is not possible,
because place p3 is empty.

227
00:16:38,360 --> 00:16:41,980
So we can mark that we
have a problem here.

228
00:16:41,980 --> 00:16:44,000
We are missing a token.

229
00:16:44,000 --> 00:16:49,860
We can simply add it, and
execute the code to the final state.

230
00:16:49,860 --> 00:16:54,597
And what we seen then is that there
is a token remaining in place p1.

231
00:16:54,597 --> 00:16:56,500
So we can see two problems.

232
00:16:56,500 --> 00:16:59,760
We missed a token and in the end,
the token is remaining.

233
00:16:59,760 --> 00:17:03,166
Indicating that b should
have been executed.

234
00:17:03,166 --> 00:17:09,041
So we can use, replay on top of
a Petri net to detect problems.

235
00:17:11,502 --> 00:17:15,204
We are still talking very
much about process models, so

236
00:17:15,204 --> 00:17:19,140
please take a look at chapter two
to see more of the details of

237
00:17:19,140 --> 00:17:22,786
the things that I've
discussed in this lecture.

238
00:17:22,786 --> 00:17:26,360
Thank you very much for watching,
and hope to see you soon.

239
00:17:26,360 --> 00:17:34,792
[MUSIC]

